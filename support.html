<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Support Ticket</title>
  
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js"></script>

  <script>
    // Wird ausgeführt, sobald die Office-Anwendung bereit ist
    Office.onReady(function (info) {
      
      // *** DAS IST DIE WICHTIGE KORREKTUR ***
      // Registriert die JavaScript-Funktion 'createSupportTicket'
      // damit das XML-Manifest (ExecuteFunction) sie finden kann.
      Office.actions.associate('createSupportTicket', createSupportTicket);

    });

    /**
     * Diese Funktion wird vom Ribbon-Button aufgerufen.
     * @param {Office.AddinCommands.Event} event - Das Klick-Ereignis.
     */
    function createSupportTicket(event) {
      
      // Öffnet ein neues E-Mail-Fenster mit vordefiniertem Empfänger
      Office.context.mailbox.displayNewMessageForm({
        toRecipients: ['support@kiener-wittlin.ch']
      });

      // Signalisiert Office, dass die Funktion erfolgreich abgeschlossen wurde.
      // (Sehr wichtig, sonst denkt Outlook, das Add-in sei abgestürzt)
      event.completed();
    }
  </script>
</head>
<body>
  </body>
</html>
