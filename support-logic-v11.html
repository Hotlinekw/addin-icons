<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Office-JavaScript-Bibliothek -->
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script>
    // Wird aufgerufen, wenn Office bereit ist (Outlook, Excel, usw.)
    Office.onReady(function() {
      // hier muss nichts passieren, reicht so
    });

    // Diese Funktion wird im Manifest als ov:FunctionName referenziert
    function createTicket(event) {
      // Neue E-Mail erstellen
      Office.context.mailbox.displayNewMessageForm({
        toRecipients: ['support@kiener-wittlin.ch']
        // subject und body bleiben bewusst leer
      });

      // Outlook sagen, dass wir fertig sind
      event.completed();
    }

    // GANZ WICHTIG: global sichtbar machen
    window.createTicket = createTicket;
  </script>
</head>
<body>
</body>
</html>
