<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Support Ticket Logic</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <script>
        // 1. Warten, bis Office bereit ist
        Office.onReady(function (info) {
            // 2. Die Funktion registrieren, damit der Ribbon-Button sie findet
            // Der Name 'createSupportTicket' MUSS exakt mit dem <FunctionName> im Manifest übereinstimmen!
            Office.actions.associate("createSupportTicket", createSupportTicket);
        });

        /**
         * Die eigentliche Funktion, die ausgeführt wird.
         * @param {Office.AddinCommands.Event} event
         */
        function createSupportTicket(event) {
            
            // Neues E-Mail-Fenster öffnen
            Office.context.mailbox.displayNewMessageForm({
                toRecipients: ['support@kiener-wittlin.ch'], // Empfänger
                subject: 'IT Support Anfrage',                // Betreff (optional)
                body: 'Hallo IT-Support,\n\nIch habe folgendes Problem:\n' // Inhalt (optional)
            });

            // WICHTIG: Dem Ribbon signalisieren, dass wir fertig sind.
            // Ohne das denkt Outlook, das Add-in ist abgestürzt.
            event.completed();
        }
    </script>
</head>
<body>
    </body>
</html>
